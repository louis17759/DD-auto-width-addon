# 数字字段

`NumberField`，继承自基础 [`Field`](./Field模块.md)类，专门用于处理数字字段数据。支持整数、小数，并提供多种数字格式化选项，如百分比、货币等。

## 字段特有方法

### getValueAsync

获取指定记录在该文本字段的值。

```typescript
getValueAsync(recordId: string): Promise<number | null>
```

**参数**

*   `recordId` : `string` - 记录ID
    

**返回值**

*   `Promise<string | null>`\- 数字值，如果记录不存在或值为空则返回null
    

**示例**

```typescript
// 获取数字字段值
const priceField = sheet.getField<NumberField>('价格');
if (priceField) {
  const price = await priceField.getValueAsync('rec123456');
  console.log(`价格: ${price !== null ? price : '无'}`);
}
```

### setValueAsync

设置指定记录在该数字字段的值。

```typescript
setValueAsync(recordId: string, num: number): Promise<boolean>
```

**参数**

*   `recordId`: `string` - 记录ID
    
*   `num`: `string` - 要设置的数字值
    

**返回值**

*   `Promise<boolean>`\- 设置是否成功
    

**示例**

```typescript
// 设置数字字段值
const priceField = sheet.getField<NumberField>('价格');
if (priceField) {
  const success = await priceField.setValueAsync('rec123456', 199.99);
  if (success) {
    console.log('价格更新成功');
  } else {
    console.log('价格更新失败');
  }
}
```

### getFormatter

获取数字字段的格式。

```typescript
getFormatter(): NumericalFormatter

type NumericalFormatter = `${NUMERICAL_FORMAT}`;
enum NUMERICAL_FORMAT {
  INT = 'INT',
  FLOAT_1 = 'FLOAT_1',
  FLOAT_2 = 'FLOAT_2',
  FLOAT_3 = 'FLOAT_3',
  FLOAT_4 = 'FLOAT_4',
  FLOAT_5 = 'FLOAT_5',
  FLOAT_6 = 'FLOAT_6',
  FLOAT_7 = 'FLOAT_7',
  FLOAT_8 = 'FLOAT_8',
  FLOAT_9 = 'FLOAT_9',
  THOUSAND = 'THOUSAND',
  THOUSAND_FLOAT = 'THOUSAND_FLOAT',
  PERCENT = 'PERCENT',
  PERCENT_FLOAT = 'PERCENT_FLOAT',
  CNY = 'CNY',
  CNY_FLOAT = 'CNY_FLOAT',
  HKD = 'HKD',
  HKD_FLOAT = 'HKD_FLOAT',
  USD = 'USD',
  USD_FLOAT = 'USD_FLOAT',
  EUR = 'EUR',
  EUR_FLOAT = 'EUR_FLOAT',
  JPY = 'JPY',
  JPY_FLOAT = 'JPY_FLOAT',
}
```

**返回值**

*   `NumericalFormatter`\- 数字格式类型
    

**示例**

```typescript
// 获取数字格式
const priceField = sheet.getField<NumberField>('价格');
if (priceField) {
  const formatter = priceField.getFormatter();
}

```

### setFormatter

设置数字字段的格式

```typescript
setFormatter(formatter: NumericalFormatter): string
```

**参数**

*   `formatter`: `NumericalFormatter`\- 数字格式
    

**返回值**

*   `string` - 字段ID
    

**示例**

```typescript
// 设置数字格式为货币类型
const priceField = sheet.getField<NumberField>('价格');
if (priceField) {
  priceField.setFormatter('CNY_FLOAT');
  console.log('已将价格字段设置为人民币格式');
}

// 设置数字格式为百分比
const rateField = sheet.getField<NumberField>('完成率');
if (rateField) {
  rateField.setFormatter('PERCENT_FLOAT');
  console.log('已将完成率字段设置为百分比格式');
}

```